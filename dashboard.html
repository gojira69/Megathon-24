<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <script>
    // Function to get URL parameters
    function getQueryParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
    }

    // Get the patient name from the URL and display it on the page
    document.addEventListener("DOMContentLoaded", function () {
        const patientName = getQueryParam('name');
        
        // Display the patient name in a suitable place, e.g., the breadcrumb or a title
        if (patientName) {
            document.querySelector('.breadcrumb-item.active').textContent = patientName;
            document.querySelector('.navbar-brand').textContent = `${patientName}'s Dashboard`;
        }
    });
  </script>

</head>
<body>
    <nav class="navbar bg-dark border-bottom border-body" data-bs-theme="dark">
        <div class="container-fluid">
            <a class="navbar-brand text-light" href="#">Dashboard</a>
            <ol class="breadcrumb mb-0 ms-auto">
                <li class="breadcrumb-item"><a href="landingpage.html" class="text-light">Home</a></li>
                <li class="breadcrumb-item active text-light" aria-current="page">User</li>
            </ol>
        </div>
    </nav>
    
    <div class="my-3"></div>
  <div class="container mt-2">
    <h2 class="text-center mb-4">Patient Dashboard</h2>

    <!-- File Upload Section -->
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Upload Files</h5>
        <form>
          <div class="form-group">
            <label for="textInput">Therapist Notes</label>
            <textarea class="form-control" id="textInput" rows="3"></textarea>
          </div>
          <div class="my-3"></div>
          <div class="form-group">
            <label for="audioInput">Upload Audio File</label>
            <input type="file" class="form-control-file" id="audioInput">
          </div>
          <div class="my-3"></div>
          <div class="form-group">
            <label for="musicInput">Upload Music History</label>
            <input type="file" class="form-control-file" id="musicInput">
          </div>
          <div class="my-3"></div>
          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
      </div>
    </div>

    <!-- Analysis Table -->
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Mental Health Analysis</h5>
        <table class="table table-striped">
          <thead>
            <tr>
              <th scope="col">Phrase</th>
              <th scope="col">Polarity</th>
              <th scope="col">Concern Classification</th>
              <th scope="col">Intensity Score</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Sample Phrase 1</td>
              <td>Positive</td>
              <td>Anxiety</td>
              <td>High</td>
            </tr>
            <!-- Repeat rows as necessary -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- Sentiment Shift Timeline -->
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Sentiment Shift Timeline</h5>
        <canvas id="sentimentChart" width="400" height="200"></canvas>
      </div>
    </div>
  </div>

  <!-- Chart.js Library for Timeline -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- <script>
        document.getElementById('musicInput').addEventListener('change', function() {
            const formData = new FormData();
            formData.append('file', this.files[0]);

            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    console.error("Error:", data.error);
                } else {
                    console.log("CSV URLs:", data.csv_files);  // These URLs can be used to fetch CSV files for further processing
                    data.csv_files.forEach(url => {
                        fetch(url)
                            .then(response => response.text())
                            .then(csvData => {
                                console.log("CSV Content:", csvData);  // Replace with your CSV parsing and plotting logic
                            })
                            .catch(error => console.error("Error reading CSV:", error));
                    });
                }
            })
            .catch(error => console.error("Error:", error));
        });
  </script> -->
  <script>
    var ctx = document.getElementById('sentimentChart').getContext('2d');
    var sentimentChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: ['Session 1', 'Session 2', 'Session 3'], // Example session labels
        datasets: [{
          label: 'Sentiment Score',
          data: [3, 5, 2], // Sample data for sentiment shift
          backgroundColor: 'rgba(75, 192, 192, 0.2)',
          borderColor: 'rgba(75, 192, 192, 1)',
          borderWidth: 1
        }]
      },
      options: {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        }
      }
    });
  </script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script></body>

</body>
</html>
